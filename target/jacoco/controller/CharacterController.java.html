<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="hu"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CharacterController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">game</a> &gt; <a href="index.source.html" class="el_package">controller</a> &gt; <span class="el_source">CharacterController.java</span></div><h1>CharacterController.java</h1><pre class="source lang-java linenums">package controller;

import com.sun.org.apache.xerces.internal.dom.ParentNode;
import javafx.animation.FadeTransition;
import javafx.application.Platform;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.fxml.Initializable;
import javafx.scene.Node;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.TextField;
import javafx.scene.image.ImageView;
import javafx.scene.layout.AnchorPane;
import javafx.scene.layout.StackPane;
import javafx.scene.text.Text;
import javafx.stage.Stage;
import javafx.util.Duration;
import modell.Player;

import java.io.IOException;
import java.net.URL;
import java.util.Random;
import java.util.ResourceBundle;
import java.util.concurrent.Executors;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.TimeUnit;


<span class="nc" id="L33">public class CharacterController implements Initializable {</span>

<span class="nc" id="L35">    Player player = new Player(WellcomeSceneController.NAME);</span>

<span class="nc" id="L37">    Random random = new Random();</span>
    int randomNumber;
<span class="nc" id="L39">    double dmgGoldAmount = 5.1;</span>
<span class="nc" id="L40">    double critChanceGoldAmount = 450;</span>
<span class="nc" id="L41">    double critDmgGoldAmount = 11.1;</span>
<span class="nc" id="L42">    double aiDmgGoldAmount = 4.1;</span>

    @FXML
    private TextField dmgBar;

    @FXML
    private TextField dmgBarGold;

    @FXML
    private TextField nameText;

    @FXML
    private TextField goldAmountField;

    @FXML
    private Button dmgPlus;

    @FXML
    private TextField yourMoney;

    @FXML
    private TextField number;

    @FXML
    private TextField youGet;

    @FXML
    private TextField critChanceBarGold;

    @FXML
    private Button critDmgPlus;

    @FXML
    private TextField critDmgBar;

    @FXML
    private TextField critDmgBarGold;

    @FXML
    private Button critChancePlus;

    @FXML
    private TextField resetGold;

    @FXML
    private TextField critChanceBar;

    @FXML
    private Button resetButton;

    @FXML
    private AnchorPane rootAnchorPane;

    @FXML
    private Button  aiDmgPlus;

    @FXML
    private TextField  aiDmgBarGold;

    @FXML
    private TextField aiDmgBar;

    @FXML
    void critChancePlusButtonClick(ActionEvent event) {

<span class="nc" id="L107">        player.critPlus(critChanceGoldAmount);</span>

<span class="nc" id="L109">        setFields();</span>

<span class="nc bnc" id="L111" title="All 2 branches missed.">        if(player.getCritical()&gt;=100){</span>
<span class="nc" id="L112">            critChancePlus.setDisable(true);</span>
        }
<span class="nc" id="L114">    }</span>
    @FXML
    void critDmgPlusButtonClick(ActionEvent event) {

<span class="nc" id="L118">        player.critDmgPlus(critDmgGoldAmount);</span>

<span class="nc" id="L120">        setFields();</span>

<span class="nc" id="L122">    }</span>
    @FXML
    void aiDmgPlusButtonClick(ActionEvent event) {

<span class="nc" id="L126">        player.aiDmgPlus(aiDmgGoldAmount);</span>

<span class="nc" id="L128">        setFields();</span>

<span class="nc" id="L130">    }</span>
    @FXML
    void resetButtonClick(ActionEvent event) {

<span class="nc" id="L134">        player.statReset();</span>

<span class="nc" id="L136">        setFields();</span>

<span class="nc" id="L138">        critChancePlus.setDisable(false);</span>

<span class="nc" id="L140">    }</span>
    @FXML
    void PlayButtonClick(ActionEvent event) {
<span class="nc bnc" id="L143" title="All 4 branches missed.">        if(player.getMoney() &gt; 0 &amp;&amp; player.getMoney() &gt;= Integer.parseInt(yourMoney.getText()) &amp;&amp;</span>
<span class="nc bnc" id="L144" title="All 6 branches missed.">                number.getText() != null &amp;&amp; Integer.parseInt(number.getText()) &lt; 11 &amp;&amp; Integer.parseInt(number.getText()) &gt; 0){</span>

<span class="nc" id="L146">            player.setMoney(player.getMoney()-Integer.parseInt(yourMoney.getText()));</span>

<span class="nc" id="L148">            randomNumber = random.nextInt(10)+1;</span>

<span class="nc" id="L150">            setFields();</span>

<span class="nc bnc" id="L152" title="All 2 branches missed.">            if(randomNumber == Integer.parseInt(number.getText())){</span>
<span class="nc" id="L153">                player.setMoney(player.getMoney()+Integer.parseInt(yourMoney.getText()) * 10);</span>

<span class="nc" id="L155">                setFields();</span>

<span class="nc" id="L157">                youGet.setText(&quot;You win: &quot; + format(Integer.parseInt(yourMoney.getText()) * 10)+&quot;G&quot;);</span>
            }else{
<span class="nc" id="L159">                youGet.setText(&quot;You Lose: &quot; + format(Integer.parseInt(yourMoney.getText()))+&quot;G&quot;);</span>
            }
        }


<span class="nc" id="L164">    }</span>



    @FXML
    void dmgPlusButtonClick(ActionEvent event) {

<span class="nc" id="L171">        player.dmgPlus(dmgGoldAmount);</span>

<span class="nc" id="L173">        setFields();</span>


<span class="nc" id="L176">    }</span>

    @FXML
    void adventureButtonClick(ActionEvent event)throws IOException {
<span class="nc" id="L180">        makeFadeOut();</span>


<span class="nc" id="L183">    }</span>
    private void makeFadeOut(){
<span class="nc" id="L185">        FadeTransition fadeTransition = new FadeTransition();</span>
<span class="nc" id="L186">        fadeTransition.setDuration(Duration.millis(1000));</span>
<span class="nc" id="L187">        fadeTransition.setNode(rootAnchorPane);</span>
<span class="nc" id="L188">        fadeTransition.setFromValue(1);</span>
<span class="nc" id="L189">        fadeTransition.setToValue(0);</span>

<span class="nc" id="L191">        fadeTransition.setOnFinished(new EventHandler&lt;ActionEvent&gt;() {</span>
            public void handle(ActionEvent event) {
<span class="nc" id="L193">                loadNextScene();</span>
<span class="nc" id="L194">            }</span>
        });
<span class="nc" id="L196">        fadeTransition.play();</span>
<span class="nc" id="L197">    }</span>

    private void loadNextScene(){

        try{
<span class="nc" id="L202">            Parent newGameViewParent = FXMLLoader.load(getClass().getResource(&quot;/fxml/Battle.fxml&quot;));</span>
<span class="nc" id="L203">            Scene newGameViewScene = new Scene(newGameViewParent);</span>

<span class="nc" id="L205">            Stage window = (Stage) rootAnchorPane.getScene().getWindow();</span>

<span class="nc" id="L207">            window.setScene(newGameViewScene);</span>
<span class="nc" id="L208">            window.show();</span>
<span class="nc" id="L209">        }catch(IOException ex){</span>
<span class="nc" id="L210">            System.out.println(&quot;Nope! &quot;+ex);</span>
<span class="nc" id="L211">        }</span>


<span class="nc" id="L214">    }</span>
    private String format(int number){
<span class="nc" id="L216">        double result = number;</span>
<span class="nc bnc" id="L217" title="All 2 branches missed.">        if(number/1000&gt;0){</span>
<span class="nc" id="L218">            return &quot;&quot;+result/1000+&quot;k &quot;;</span>
        }
<span class="nc" id="L220">        return &quot;&quot;+result;</span>
    }
    void setFields(){
<span class="nc bnc" id="L223" title="All 2 branches missed.">        if(player.getCritical()&gt;=100){</span>
<span class="nc" id="L224">            critChancePlus.setDisable(true);</span>
        }
<span class="nc" id="L226">        aiDmgBar.setText(&quot;&quot;+format(player.getAiDmg()));</span>
<span class="nc" id="L227">        aiDmgBarGold.setText(&quot;&quot;+format((int)(player.getAiDmg()*aiDmgGoldAmount))+&quot;G&quot;);</span>
<span class="nc" id="L228">        nameText.setText(player.getName());</span>
<span class="nc" id="L229">        goldAmountField.setText(&quot;&quot;+format(player.getMoney())+&quot;G&quot;);</span>
<span class="nc" id="L230">        dmgBar.setText(&quot;&quot;+format(player.getDmg()));</span>

<span class="nc" id="L232">        critChanceBar.setText(&quot;&quot;+format(player.getCritical()));</span>
<span class="nc" id="L233">        critDmgBar.setText(&quot;&quot;+format(player.getCriticalDmg()));</span>

<span class="nc" id="L235">        dmgBarGold.setText(&quot;&quot;+ format((int)(player.getDmg() * dmgGoldAmount)) +&quot;G&quot;);</span>
<span class="nc" id="L236">        resetGold.setText(&quot;&quot;+format(player.getResetCount()*100000+100000)+&quot;G&quot;);</span>
<span class="nc" id="L237">        critChanceBarGold.setText(&quot;&quot;+format((int)(player.getCritical() * critChanceGoldAmount))+&quot;G&quot;);</span>
<span class="nc" id="L238">        critDmgBarGold.setText(&quot;&quot;+format((int)(player.getCriticalDmg() * critDmgGoldAmount))+&quot;G&quot;);</span>

<span class="nc" id="L240">        player.save();</span>
<span class="nc" id="L241">    }</span>


    public void initialize(URL url, ResourceBundle rb){
<span class="nc" id="L245">        ScheduledExecutorService exec = Executors.newSingleThreadScheduledExecutor();</span>
<span class="nc" id="L246">        Platform.setImplicitExit(false);</span>

<span class="nc" id="L248">        exec.scheduleAtFixedRate(new Runnable() {</span>

            public void run() {
<span class="nc" id="L251">                Platform.runLater(new Runnable() {</span>
                    public void run() {
<span class="nc" id="L253">                        goldAmountField.setText(&quot;&quot;+format(player.getMoney())+&quot;G&quot;);</span>
<span class="nc" id="L254">                    }</span>
                });

<span class="nc" id="L257">            }</span>
        }, 0, 500, TimeUnit.MILLISECONDS);
<span class="nc" id="L259">        setFields();</span>


<span class="nc" id="L262">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>